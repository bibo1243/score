<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114(下)員工績效考核評分分析</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e8e8e8;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 30px;
        }

        .header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            border-radius: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.8;
            font-size: 1.1em;
        }

        /* 統計卡片 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            background: linear-gradient(135deg, #00d2ff, #3a7bd5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            opacity: 0.8;
            margin-top: 5px;
        }

        /* 分頁導航 */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 15px;
        }

        .tab {
            padding: 12px 24px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: #e8e8e8;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab:hover {
            background: rgba(102, 126, 234, 0.5);
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        /* 內容區 */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 員工表格 */
        .employee-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .employee-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 18px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95em;
        }

        .employee-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            vertical-align: middle;
        }

        .employee-table tbody tr:hover {
            background: rgba(102, 126, 234, 0.15);
        }

        /* 評分進度條 */
        .score-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .score-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .score-fill.cat1 {
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .score-fill.cat2 {
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
        }

        .score-fill.cat3 {
            background: linear-gradient(90deg, #f093fb, #f5576c);
        }

        /* 分數顯示 */
        .score-display {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .score-value {
            font-weight: 700;
            font-size: 1.1em;
            min-width: 45px;
        }

        .expected {
            color: #888;
            font-size: 0.9em;
        }

        /* 評分來源標籤 */
        .source-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .source-tag {
            display: inline-block;
            padding: 4px 10px;
            background: rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            font-size: 0.8em;
        }

        /* 職位標籤 */
        .position-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
        }

        .position-badge.manager {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .position-badge.senior {
            background: linear-gradient(135deg, #00d2ff, #3a7bd5);
        }

        .position-badge.general {
            background: rgba(255, 255, 255, 0.2);
        }

        .position-badge.exempt {
            background: #dc3545;
        }

        /* 狀態標籤 */
        .status-badge {
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 0.8em;
        }

        .status-badge.complete {
            background: #28a745;
        }

        .status-badge.partial {
            background: #ffc107;
            color: #000;
        }

        .status-badge.pending {
            background: #dc3545;
        }

        /* 總分區塊 */
        .total-score {
            font-size: 1.3em;
            font-weight: 700;
            padding: 8px 15px;
            border-radius: 10px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.4), rgba(118, 75, 162, 0.4));
        }

        /* 說明區 */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 5px;
        }

        /* 響應式 */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .employee-table {
                font-size: 0.9em;
            }

            .tabs {
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>114(下)員工績效考核評分分析</h1>
            <p>分析每位員工的應評分來源、實際評分狀況與三大類評分結果</p>
        </div>

        <!-- 統計總覽 -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalEmployees">52</div>
                <div class="stat-label">總考核人數</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedCount">0</div>
                <div class="stat-label">已完成評核</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pendingCount">52</div>
                <div class="stat-label">待評核</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgScore">--</div>
                <div class="stat-label">平均分數</div>
            </div>
        </div>

        <!-- 評分說明 -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #667eea, #764ba2);"></div>
                <span>第一類 (40分)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #00d2ff, #3a7bd5);"></div>
                <span>第二類 (30分)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #f093fb, #f5576c);"></div>
                <span>第三類 (30分)</span>
            </div>
        </div>

        <!-- 單位分頁 -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('all')">全部人員</button>
            <button class="tab" onclick="showTab('children')">兒少之家</button>
            <button class="tab" onclick="showTab('youth')">少年家園</button>
            <button class="tab" onclick="showTab('counsel')">諮商所</button>
            <button class="tab" onclick="showTab('admin')">行政組</button>
            <button class="tab" onclick="showTab('social')">社資組</button>
            <button class="tab" onclick="showTab('education')">圖書教育組</button>
        </div>

        <!-- 全部人員 -->
        <div id="all" class="tab-content active">
            <table class="employee-table">
                <thead>
                    <tr>
                        <th>單位</th>
                        <th>姓名</th>
                        <th>職位</th>
                        <th>應被評分來源</th>
                        <th>實際評分狀態</th>
                        <th>第一類(40)</th>
                        <th>第二類(30)</th>
                        <th>第三類(30)</th>
                        <th>總分(100)</th>
                    </tr>
                </thead>
                <tbody id="allEmployeesTable">
                    <!-- 資料將由 JavaScript 動態填入 -->
                </tbody>
            </table>
        </div>

        <!-- 各單位分頁（結構相同） -->
        <div id="children" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">兒少之家</h2>
            <table class="employee-table">
                <thead>
                    <tr>
                        <th>姓名</th>
                        <th>職位</th>
                        <th>應被評分來源</th>
                        <th>實際評分狀態</th>
                        <th>第一類(40)</th>
                        <th>第二類(30)</th>
                        <th>第三類(30)</th>
                        <th>總分(100)</th>
                    </tr>
                </thead>
                <tbody id="childrenTable"></tbody>
            </table>
        </div>

        <div id="youth" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">少年家園</h2>
            <table class="employee-table">
                <thead>
                    <tr>
                        <th>姓名</th>
                        <th>職位</th>
                        <th>應被評分來源</th>
                        <th>實際評分狀態</th>
                        <th>第一類(40)</th>
                        <th>第二類(30)</th>
                        <th>第三類(30)</th>
                        <th>總分(100)</th>
                    </tr>
                </thead>
                <tbody id="youthTable"></tbody>
            </table>
        </div>

        <div id="counsel" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">諮商所</h2>
            <table class="employee-table">
                <thead>
                    <tr>
                        <th>姓名</th>
                        <th>職位</th>
                        <th>應被評分來源</th>
                        <th>實際評分狀態</th>
                        <th>第一類(40)</th>
                        <th>第二類(30)</th>
                        <th>第三類(30)</th>
                        <th>總分(100)</th>
                    </tr>
                </thead>
                <tbody id="counselTable"></tbody>
            </table>
        </div>

        <div id="admin" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">行政組</h2>
            <table class="employee-table">
                <thead>
                    <tr>
                        <th>姓名</th>
                        <th>職位</th>
                        <th>應被評分來源</th>
                        <th>實際評分狀態</th>
                        <th>第一類(40)</th>
                        <th>第二類(30)</th>
                        <th>第三類(30)</th>
                        <th>總分(100)</th>
                    </tr>
                </thead>
                <tbody id="adminTable"></tbody>
            </table>
        </div>

        <div id="social" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">社資組</h2>
            <table class="employee-table">
                <thead>
                    <tr>
                        <th>姓名</th>
                        <th>職位</th>
                        <th>應被評分來源</th>
                        <th>實際評分狀態</th>
                        <th>第一類(40)</th>
                        <th>第二類(30)</th>
                        <th>第三類(30)</th>
                        <th>總分(100)</th>
                    </tr>
                </thead>
                <tbody id="socialTable"></tbody>
            </table>
        </div>

        <div id="education" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #667eea;">圖書教育組</h2>
            <table class="employee-table">
                <thead>
                    <tr>
                        <th>姓名</th>
                        <th>職位</th>
                        <th>應被評分來源</th>
                        <th>實際評分狀態</th>
                        <th>第一類(40)</th>
                        <th>第二類(30)</th>
                        <th>第三類(30)</th>
                        <th>總分(100)</th>
                    </tr>
                </thead>
                <tbody id="educationTable"></tbody>
            </table>
        </div>
    </div>

    <script>
        // 員工資料結構 (依據 index.html 整理)
        const employees = [
            // 兒少之家
            { unit: '兒少之家', name: '廖振杉', position: 'manager', sources: ['教保組單位主管', '資深員工', '一般員工'], sourceRatio: '100%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '陳宛妤', position: 'manager', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '簡采琦', position: 'senior', sources: ['主管 50%', '社工股 40%', '資深+一般員工 10%'], sourceRatio: '50%+40%+10%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '林東美', position: 'senior', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '賀郁茵', position: 'senior', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '廖玟慈', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '張宜芳', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '蕭婷予', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '陳亮寧', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '王卉蓁', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '許芸嘉', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '李炎煇', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '兒少之家', name: '曾婷婷', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },

            // 少年家園
            { unit: '少年家園', name: '廖慧雯', position: 'manager', sources: ['教保組單位主管', '督導', '資深', '一般員工'], sourceRatio: '100%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '鍾宜珮', position: 'manager', sources: ['主管 50%', '督導+資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '林品亨', position: 'manager', sources: ['主管 50%', '生輔 40%', '資深+一般員工 10%'], sourceRatio: '50%+40%+10%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '蘇盟惠', position: 'senior', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '劉宛宣', position: 'senior', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '郭楷欣', position: 'senior', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '吳秉熹', position: 'senior', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '胡少淇', position: 'senior', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '陳昱綸', position: 'general', sources: ['主管 50%', '資深+一般員工互評 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '黃穎蓁', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '蔣郡哲', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '劉婷瑜', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '少年家園', name: '吳思函', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },

            // 諮商所
            { unit: '諮商所', name: '楊顗帆', position: 'manager', sources: ['一般員工'], sourceRatio: '100%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '諮商所', name: '陳柔安', position: 'general', sources: ['主管 50%', '該所員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '諮商所', name: '林彥秀', position: 'general', sources: ['主管 50%', '該所員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },

            // 行政組
            { unit: '行政組', name: '李冠葦', position: 'manager', sources: ['庶務股長', '資深員工', '一般員工'], sourceRatio: '100%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '陳淑錡', position: 'manager', sources: ['主管 50%', '庶務股長+資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '林紀騰', position: 'senior', sources: ['主管 50%', '該股股員 30%', '其他組員 20%'], sourceRatio: '50%+30%+20%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '王芊蓉', position: 'senior', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '李鳳翎', position: 'senior', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '王元鼎', position: 'senior', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '林港博', position: 'senior', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '謝秀桃', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '羅如光', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '陸廷瑋', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '林麗娟', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '徐銘澤', position: 'general', sources: ['主管 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '劉春燕', position: 'general', sources: ['主管(主任+組長) 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '行政組', name: '熊小蓮', position: 'general', sources: ['主管(主任+組長) 50%', '資深+一般員工 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },

            // 社資組
            { unit: '社資組', name: '王姿斐', position: 'general', sources: ['主管(總幹事+社資組長) 50%', '行政組(不含廚師) 50%'], sourceRatio: '50%+50%', cat1: null, cat2: null, cat3: null, status: 'pending' },

            // 圖書教育組
            { unit: '圖書教育組', name: '高靜華', position: 'manager', sources: ['總幹事', '兩家園主任'], sourceRatio: '100%', cat1: null, cat2: null, cat3: null, status: 'pending' },
            { unit: '圖書教育組', name: '淨惠', position: 'exempt', sources: ['免考核'], sourceRatio: '-', cat1: null, cat2: null, cat3: null, status: 'exempt' },
        ];

        // 職位對應中文
        const positionLabels = {
            manager: '主管',
            senior: '資深',
            general: '一般',
            exempt: '免考核'
        };

        // 單位對應表格ID
        const unitTableMap = {
            '兒少之家': 'childrenTable',
            '少年家園': 'youthTable',
            '諮商所': 'counselTable',
            '行政組': 'adminTable',
            '社資組': 'socialTable',
            '圖書教育組': 'educationTable'
        };

        // 渲染員工列
        function renderEmployeeRow(emp, showUnit = false) {
            const total = (emp.cat1 || 0) + (emp.cat2 || 0) + (emp.cat3 || 0);
            const statusClass = emp.status === 'complete' ? 'complete' : emp.status === 'partial' ? 'partial' : 'pending';
            const statusText = emp.status === 'complete' ? '已完成' : emp.status === 'partial' ? '部分完成' : emp.status === 'exempt' ? '免考核' : '待評核';

            let row = '<tr>';
            if (showUnit) row += `<td>${emp.unit}</td>`;
            row += `
                <td><strong>${emp.name}</strong></td>
                <td><span class="position-badge ${emp.position}">${positionLabels[emp.position]}</span></td>
                <td><div class="source-tags">${emp.sources.map(s => `<span class="source-tag">${s}</span>`).join('')}</div></td>
                <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                <td>
                    <div class="score-display">
                        <span class="score-value">${emp.cat1 !== null ? emp.cat1 : '--'}</span>
                        <span class="expected">/ 40</span>
                    </div>
                    <div class="score-bar"><div class="score-fill cat1" style="width: ${(emp.cat1 || 0) / 40 * 100}%"></div></div>
                </td>
                <td>
                    <div class="score-display">
                        <span class="score-value">${emp.cat2 !== null ? emp.cat2 : '--'}</span>
                        <span class="expected">/ 30</span>
                    </div>
                    <div class="score-bar"><div class="score-fill cat2" style="width: ${(emp.cat2 || 0) / 30 * 100}%"></div></div>
                </td>
                <td>
                    <div class="score-display">
                        <span class="score-value">${emp.cat3 !== null ? emp.cat3 : '--'}</span>
                        <span class="expected">/ 30</span>
                    </div>
                    <div class="score-bar"><div class="score-fill cat3" style="width: ${(emp.cat3 || 0) / 30 * 100}%"></div></div>
                </td>
                <td><span class="total-score">${emp.cat1 !== null ? total : '--'}</span></td>
            `;
            row += '</tr>';
            return row;
        }

        // 初始化表格
        function initTables() {
            // 全部員工表格
            const allTable = document.getElementById('allEmployeesTable');
            allTable.innerHTML = employees.map(emp => renderEmployeeRow(emp, true)).join('');

            // 各單位表格
            Object.entries(unitTableMap).forEach(([unit, tableId]) => {
                const table = document.getElementById(tableId);
                const unitEmployees = employees.filter(e => e.unit === unit);
                table.innerHTML = unitEmployees.map(emp => renderEmployeeRow(emp, false)).join('');
            });
        }

        // 更新統計
        function updateStats() {
            const total = employees.filter(e => e.status !== 'exempt').length;
            const completed = employees.filter(e => e.status === 'complete').length;
            const pending = total - completed;

            document.getElementById('totalEmployees').textContent = total;
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('pendingCount').textContent = pending;

            const scoredEmployees = employees.filter(e => e.cat1 !== null);
            if (scoredEmployees.length > 0) {
                const avg = scoredEmployees.reduce((sum, e) => sum + e.cat1 + e.cat2 + e.cat3, 0) / scoredEmployees.length;
                document.getElementById('avgScore').textContent = avg.toFixed(1);
            }
        }

        // 分頁切換
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // 初始化
        initTables();
        updateStats();
    </script>
</body>

</html>